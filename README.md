# 项目说明

本项目实现了一个问答机器人，整体结构如下：

## 1. main.py 调用 agent_graph.py

`main.py` 是项目的入口文件。在 `main.py` 中，会调用 `agent_graph.py` 中的 `create_agent_graph()` 方法，构建整个问答流程的智能体图（Agent Graph），并通过该图对用户输入进行处理和响应。

## 2. 机器人问答流程（基于 agent_graph.py 的结构）

在 `agent_graph.py` 中，定义了问答机器人的核心流程。整个流程分为以下几个步骤，每一步都是一个 Agent 节点：

- **(1) 对话前验证 & 安全过滤（prior_validation）**  
  检查用户输入是否包含有害、攻击性或不当内容（如毒性检测），如果检测不通过则拒绝服务。

- **(2) 语言检测（language）**  
  自动识别用户输入的语言（支持简体中文、繁体中文、英文等）。

- **(3) 意图识别（intention）**  
  判断用户问题属于哪种类型（如费率查询、对比、资格验证、流程咨询等）。

- **(4) 响应生成（generation）**  
  根据意图和语言，调用不同的 LLM 生成回复。

- **(5) 对话后验证 & 安全过滤（post_validation）**  
  对生成的回复再次进行安全性和合规性检测（如毒性检测、拒答检测），确保回复内容安全、合规。

## 3. agent_graph.py 调用的两个 LLM

在 `agent_graph.py` 中，机器人会根据意图选择调用不同的 LLM：

- **网络结构化知识图谱 LLM** (chatbot_with_kg.py) 
  该 LLM 结合了结构化的知识图谱（Knowledge Graph），适合处理需要精确、权威知识的问答场景（如费率、政策等）。

- **无结构化（基于向量数据库的）LLM**  (chatbot_baseline.py)
  该 LLM 基于向量数据库（VectorDB）存储的无结构化知识，适合处理开放性、泛化性较强的问题。

通过上述流程，机器人能够实现对用户输入的多层次理解和安全把控，并根据不同场景调用最合适的 LLM 进行回复，提升问答的准确性和安全性。
